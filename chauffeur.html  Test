<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Chauffeur CizaRide+</title>
<link rel="icon" href="logotransparent.png">

<style>
    body{
        margin:0;
        padding:0;
        background:#06142E;
        font-family:Arial, sans-serif;
        color:white;
        text-align:center;
    }

    .header{
        padding:20px;
        background:#0A1A3A;
        font-size:22px;
        font-weight:700;
        color:#F2B840;
        box-shadow:0 0 20px rgba(0,0,0,0.4);
    }

    .card{
        width:90%;
        margin:20px auto;
        padding:20px;
        border-radius:18px;
        background:rgba(255,255,255,0.05);
        border:1px solid rgba(255,255,255,0.12);
        backdrop-filter:blur(10px);
        box-shadow:0 0 18px rgba(0,0,0,0.3);
        text-align:center;
    }

    .status-badge{
        display:inline-block;
        padding:8px 14px;
        border-radius:50px;
        font-weight:700;
        margin-top:10px;
        font-size:14px;
    }

    .online{ background:#28C840; }
    .offline{ background:#C62828; }

    .toggle-btn{
        width:90%;
        margin:20px auto;
        padding:18px;
        background:#F2B840;
        color:#06142E;
        border:none;
        border-radius:12px;
        font-size:20px;
        font-weight:700;
        cursor:pointer;
        box-shadow:0 0 20px rgba(242,184,64,0.4);
    }

    .toggle-btn:active{
        transform:scale(0.97);
    }
</style>
</head>
<body>

<div class="header">ðŸš– Tableau de Bord Chauffeur</div>

<div class="card">
    <h2 id="driverName">Chargement...</h2>
    <p id="driverVehicle"></p>

    <div id="statusBadge" class="status-badge offline">Offline</div>
</div>

<button class="toggle-btn" id="toggleStatus">Changer le statut</button>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// --------------------
// CONFIG FIREBASE
// --------------------
const firebaseConfig = {
  apiKey: "AIzaSyCgxkjBzNfovAsWwk86IXII0T-yuj3GDAY",
  authDomain: "cizagroup-app.firebaseapp.com",
  projectId: "cizagroup-app",
  storageBucket: "cizagroup-app.appspot.com",
  messagingSenderId: "746243280677",
  appId: "1:746243280677:web:869e6d200e74d89776f4c3"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// --------------------
// ID DU CHAUFFEUR (Ã  remplacer plus tard automatiquement)
// --------------------
const DRIVER_ID = "q9MQYSM0lgRmNJlYPn6o";  // ðŸ‘ˆ Ton chauffeur test

const driverRef = doc(db, "drivers", DRIVER_ID);

// --------------------
// Charger les infos chauffeur
// --------------------
async function loadDriver(){
    const snap = await getDoc(driverRef);
    if(!snap.exists()){
        alert("Chauffeur introuvable !");
        return;
    }

    const data = snap.data();

    document.getElementById("driverName").innerText = data.name;
    document.getElementById("driverVehicle").innerText = "ðŸš— " + data.vehicule;

    updateStatusBadge(data.status);
}

function updateStatusBadge(status){
    const badge = document.getElementById("statusBadge");
    if(status === "online"){
        badge.className = "status-badge online";
        badge.innerText = "ONLINE";
    } else {
        badge.className = "status-badge offline";
        badge.innerText = "OFFLINE";
    }
}

// --------------------
// Bouton ON/OFF
// --------------------
document.getElementById("toggleStatus").addEventListener("click", async () => {
    const snap = await getDoc(driverRef);
    const current = snap.data().status;

    const newStatus = current === "online" ? "offline" : "online";

    await updateDoc(driverRef, { status: newStatus });

    updateStatusBadge(newStatus);

    alert("Statut mis Ã  jour : " + newStatus.toUpperCase());
});

// Charger au dÃ©marrage
loadDriver();
</script>

</body>
</html>
