<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>CIZA GROUP — Création de compte</title>
<link rel="icon" href="logotransparent.png">

<style>
body{
    margin:0;
    background:#06142e;
    font-family:Arial, sans-serif;
    color:white;
}
.container{
    max-width:380px;
    margin:120px auto;
    background:#0b1c34cc;
    padding:30px;
    border-radius:18px;
    border:1px solid #12335c;
    box-shadow:0 0 18px #00000040;
}
h2{
    text-align:center;
    color:#F2B840;
    margin-top:0;
}
input{
    width:100%;
    padding:14px;
    margin:10px 0;
    border:none;
    border-radius:10px;
    background:#112544;
    color:white;
}
button{
    width:100%;
    padding:14px;
    background:#F2B840;
    color:#06142e;
    border:none;
    border-radius:10px;
    font-size:16px;
    font-weight:bold;
    cursor:pointer;
    margin-top:10px;
}
button:hover{ background:#c99933; }

.error-box{
    background:#ff444466;
    padding:10px;
    border-left:4px solid #ff1a1a;
    margin-bottom:10px;
    display:none;
    border-radius:6px;
}
.success-box{
    background:#22bb4466;
    padding:10px;
    border-left:4px solid #11aa33;
    margin-bottom:10px;
    display:none;
    border-radius:6px;
}

.link{
    margin-top:18px;
    text-align:center;
}
.link a{
    color:#F2B840;
    text-decoration:none;
}
.link a:hover{ text-decoration:underline; }
</style>
</head>

<body>

<div class="container">
    <h2>Créer un compte</h2>

    <div id="error" class="error-box"></div>
    <div id="success" class="success-box"></div>

    <input type="text" id="name" placeholder="Nom complet" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Mot de passe" required>

    <button onclick="register()">Créer mon compte</button>

    <div class="link">
        <a href="login.html">⬅ Déjà un compte ? Se connecter</a>
    </div>
</div>

<!-- FIREBASE -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, updateProfile }
       from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBAiJHbBvRO6cDFpm6C-5mQk6SiTtzcI8o",
        authDomain: "cizagroup-app.firebaseapp.com",
        projectId: "cizagroup-app",
        storageBucket: "cizagroup-app.firebasestorage.app",
        messagingSenderId: "930936264084",
        appId: "1:930936264084:web:5395360e54bf17bf492b81"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    window.register = function(){
        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        const errorBox = document.getElementById("error");
        const successBox = document.getElementById("success");

        errorBox.style.display="none";
        successBox.style.display="none";

        if(name === "" || email === "" || password === ""){
            errorBox.innerHTML = "Tous les champs sont obligatoires.";
            errorBox.style.display="block";
            return;
        }

        if(password.length < 6){
            errorBox.innerHTML = "Le mot de passe doit contenir au moins 6 caractères.";
            errorBox.style.display="block";
            return;
        }

        createUserWithEmailAndPassword(auth, email, password)
        .then((userCredential)=>{
            const user = userCredential.user;

            // Ajout du nom dans le profil utilisateur
            updateProfile(user, { displayName: name });

            successBox.innerHTML = "Compte créé avec succès. Redirection...";
            successBox.style.display = "block";

            setTimeout(()=>{
                window.location.href = "login.html";
            },1500);
        })
        .catch((err)=>{
            let msg = "Erreur inconnue";

            if(err.code === "auth/email-already-in-use") msg = "Cet email est déjà utilisé.";
            if(err.code === "auth/invalid-email") msg = "Email invalide.";
            if(err.code === "auth/operation-not-allowed") msg = "Inscription désactivée.";
            if(err.code === "auth/weak-password") msg = "Mot de passe trop faible.";

            errorBox.innerHTML = msg;
            errorBox.style.display="block";
        });
    }
</script>

</body>
</html>
