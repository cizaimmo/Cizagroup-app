<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>CizaRide+ â€” Commander un trajet</title>
<link rel="icon" href="logotransparent.png">

<style>
body{
    margin:0;
    background:#06142E;
    color:white;
    font-family:Arial, sans-serif;
}
header{
    padding:20px;
    text-align:center;
    border-bottom:1px solid #12335C;
}
header img{ width:90px; }
header h2{ color:#F2B840; margin:10px 0 0; }

.container{
    max-width:420px;
    margin:40px auto;
    background:#0B1C34;
    padding:25px;
    border-radius:14px;
    border:1px solid #12335C;
}
input{
    width:100%;
    padding:12px;
    margin-top:12px;
    border:none;
    border-radius:8px;
    background:#112544;
    color:white;
}
button{
    width:100%;
    padding:12px;
    margin-top:18px;
    background:#0b84ff;
    color:white;
    border:none;
    border-radius:8px;
    font-weight:bold;
    cursor:pointer;
}
button:hover{ background:#0466c8; }
.msg{
    margin-top:15px;
    text-align:center;
}
</style>
</head>

<body>

<header>
    <img src="logotransparent.png">
    <h2>Commander un trajet</h2>
</header>

<div class="container">
    <input type="text" id="pickup" placeholder="Lieu de dÃ©part">
    <input type="text" id="destination" placeholder="Destination">

    <button onclick="orderRide()">Commander</button>

    <div class="msg" id="msg"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } 
from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBAiJHbBvRO6cDFpm6C-5mQk6SiTtzcI8o",
  authDomain: "cizagroup-app.firebaseapp.com",
  projectId: "cizagroup-app"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

let currentUser = null;

onAuthStateChanged(auth, (user)=>{
    if(!user){
        window.location.href = "login.html";
    }else{
        currentUser = user;
    }
});

window.orderRide = async function(){
    const pickup = document.getElementById("pickup").value;
    const destination = document.getElementById("destination").value;
    const msg = document.getElementById("msg");

    if(!pickup || !destination){
        msg.textContent = "Veuillez remplir tous les champs.";
        return;
    }

    await addDoc(collection(db, "rides"), {
        clientId: currentUser.uid,
        pickup,
        destination,
        status: "pending",
        createdAt: serverTimestamp()
    });

    msg.textContent = "ðŸš— Trajet crÃ©Ã© avec succÃ¨s !";
    msg.style.color = "#4ade80";

    setTimeout(()=>{
        window.location.href = "dashboard.html";
    },1500);
};
</script>

</body>
</html>
