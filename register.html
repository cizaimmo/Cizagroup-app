<!DOCTYPE html>
<html lang="fr">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Créer un compte — CIZA GROUP</title>
<link rel="icon" href="logotransparent.png">

<style>
body {
    margin: 0;
    background: #06142e;
    font-family: Arial, sans-serif;
    color: white;
}

/* HEADER */
header {
    padding: 20px;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #0e2a50;
    background: #06142e;
}
header img {
    height: 55px;
}

/* CONTAINER */
.container {
    max-width: 400px;
    margin: auto;
    margin-top: 50px;
    padding: 25px;
    background: #0b1c34cc;
    border-radius: 16px;
    border: 1px solid #12335c;
}

h2 {
    text-align: center;
    color: #F2B840;
    margin-bottom: 10px;
}
p {
    text-align: center;
    opacity: .8;
    margin-bottom: 20px;
}

/* FORM */
input {
    width: 100%;
    padding: 14px;
    margin: 8px 0;
    border-radius: 10px;
    border: none;
    background: #112544;
    color: white;
}

button {
    width: 100%;
    padding: 14px;
    margin-top: 12px;
    background: #F2B840;
    color: #06142e;
    border: none;
    border-radius: 10px;
    font-weight: bold;
    cursor: pointer;
}
button:hover {
    background: #c99933;
}

.error {
    color: #ff5c5c;
    text-align: center;
    margin-top: 10px;
}
.success {
    color: #67ff9a;
    text-align: center;
    margin-top: 10px;
}

.login-link {
    text-align: center;
    margin-top: 18px;
}
.login-link a {
    color: #F2B840;
}

</style>
</head>

<body>

<header>
    <img src="logotransparent.png">
</header>

<div class="container">

    <h2>Créer un compte</h2>
    <p>Rejoignez la plateforme officielle CIZA GROUP</p>

    <input type="text" id="name" placeholder="Nom complet" required>
    <input type="email" id="email" placeholder="Adresse email" required>
    <input type="password" id="password" placeholder="Mot de passe" required>
    <button onclick="register()">Créer mon compte</button>

    <div id="msg"></div>

    <div class="login-link">
        <p>Déjà un compte ? <a href="index.html">Connexion</a></p>
    </div>

</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { 
    getAuth, 
    createUserWithEmailAndPassword,
    updateProfile,
    sendEmailVerification 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBAiJHbBvRO6cDFpm6C-5mQk6SiTtzcI8o",
  authDomain: "cizagroup-app.firebaseapp.com",
  projectId: "cizagroup-app",
  storageBucket: "cizagroup-app.firebasestorage.app",
  messagingSenderId: "930936264084",
  appId: "1:930936264084:web:5395360e54bf17bf492b81",
  measurementId: "G-1KX6EN1KST"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.register = function () {
    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();
    const msgBox = document.getElementById("msg");

    msgBox.innerHTML = "";

    if (!name || !email || !password) {
        msgBox.innerHTML = "<p class='error'>Veuillez remplir tous les champs.</p>";
        return;
    }

    createUserWithEmailAndPassword(auth, email, password)
        .then(async (userCredential) => {
            const user = userCredential.user;

            // Ajout du nom dans Firebase Auth
            await updateProfile(user, { displayName: name });

            // Vérification email
            await sendEmailVerification(user);

            msgBox.innerHTML = `
                <p class='success'>
                    ✔ Compte créé avec succès !<br>
                    Un email de vérification vous a été envoyé.
                </p>
            `;

            setTimeout(() => {
                window.location.href = "dashboard.html";
            }, 1500);
        })
        .catch((error) => {
            msgBox.innerHTML = "<p class='error'>" + error.message + "</p>";
        });
};
</script>

</body>
</html>
